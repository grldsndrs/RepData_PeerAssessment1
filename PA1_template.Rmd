---
title: "Reproducible Research: Peer Assessment 1"
author: "grldsndrs"
date: "January 7, 2016"
output: 
  html_document:
    keep_md: true
---
 ```{r echo=FALSE}
 date()
 ```

## Loading and preprocessing the data

library('ProjectTemplate')
load.project()

 _"Project Template"_ uses the defualt settings to 'load.project()' the csv
 file in the data folder of the working diriectory.

### Data cleaning

```{r echo=TRUE}
tidyData <- activity[complete.cases(activity),]
```

### Data tidying

> create a time series by adding the intervals in minutes to the date

dts <- as.POSIXct(tidyData$date) + minutes(as.numeric(tidyData$interval))

> __choose appropriate classes for features__

```{r echo=TRUE}
tidyData <- mutate(tidyData,
                   steps= as.numeric(steps),
                   date = as.factor(date),
                   interval=as.numeric(interval))
```

> __create a time series__

```{r eval = TRUE}
tidyDataXTS <- xts(tidyData ,order.by = dts,unique = TRUE)
```

```{r echo=TRUE}
print(head(sample_n(tidyData,nrow(tidyData))))
```

#### What is mean total number of steps taken per day?

> calculate the **_total number of steps taken per day_**

```{r eval=TRUE}
dys = endpoints(tidyDataXTS, 'days')

tidyData <- group_by(tidyData, date)%>%
  summarise(meanSteps.Dy = mean(steps),
            medianSteps.Dy=median(steps),
            steps.Dy = sum(steps),
            maxSteps.Dy=max(steps))%>%
  merge(tidyData)%>%
  mutate(meanSteps.Dy.Dys=(meanSteps.Dy*steps.Dy/sum(steps)))

tidyDataXTS <- xts(tidyData ,order.by = dts,unique = TRUE)
```

```{r echo=TRUE}
print(sample(tidyData$steps.Dy,10))
```

> make a histogram of the **_total number of steps taken per day_**

```{r, echo=FALSE}
# create extra margin room on the right for an axis
 par(mar=c(5, 5, 4, 2) + 0.1,mgp=c(4,1,0))
 plot.xts(tidyDataXTS$steps.Dy, type = 'h',# histogram
   major.ticks = 'days',
   minor.ticks = FALSE,
   las = 2,
   xaxt = "n",
         xlab = "day",
         ylab = "Total Number of Steps in day",
        main = "Counts of Data Acquisitioned Steps")
axis(1, at=dts[dys],labels=1:(length(dys)-1),las=1)
```

> calculate and report **_the mean_**

```{r echo=TRUE}
print(sample(tidyData$meanSteps.Dy,10))
```

 > and **_the median_**
 
```{r echo=TRUE}
print(sample(tidyData$medianSteps.Dy,10))
```

> of **_total number of steps taken in a day per day_**

#### What is the average daily activity pattern?

> Make a time series plot of the 5-minute interval

```{r, echo=FALSE}
par(mar=c(5, 5, 5, 12) + 0.1,mgp=c(4,1,0))
plot.xts(
   tidyDataXTS$meanSteps.Dy.Dys,
  major.ticks = 'days',
  minor.ticks = FALSE,
  col = "black",
  las = 2,
  xaxt = "n",
  type = "l",# line
  xlab = "day",
  ylab = "average number of steps taken in a day",
  main = "Average Daily Activity Pattern"
)
par(new=TRUE)
plot.xts(
 tidyDataXTS$maxSteps.Dy,
  major.ticks = 'days',
  minor.ticks = FALSE,
  col = "gray",
  las = 2,
  yaxt = "n",
  xaxt = "n",
  type = "l",# line
  main =""
)
axis(4, at=quantile(tidyData$maxSteps.Dy,names = FALSE),las=1)
mtext("max number of steps on day",side=4,line=3)
axis(1, at=dts[dys],labels=1:(length(dys)-1),las=1)
par( xpd = TRUE ,mar = par()$mar + c(0,0,0,7))
legend(x = "bottomright", inset = c(-0.7,1.1),
      c("Interal has max num steps", "Avg num steps/day", "Max steps/day"),
      col = c("blue","black", "gray"),
      lwd = c(3,2, 2),
      bty ="n")
par(xpd = FALSE,mar=c(5, 5, 5, 12) + 0.1,mgp=c(4,1,0))
maxNumStepsValue = max(tidyData$steps)
maxNumStepsDateTime = dts[tidyData$steps==maxNumStepsValue]
abline( v = maxNumStepsDateTime, col = "blue", ,lwd = 3)
points(maxNumStepsDateTime, maxNumStepsValue, cex= 1, pch =16,col="red")
```

#### Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

> **_The interval is indicated by the red dot on the above plot._**

> It is calculated:

```{r eval=TRUE}
maxNumStepsValue = max(tidyData$steps)
intervalOfMax = tidyData$interval[tidyData$steps==maxNumStepsValue]
maxNumStepsDateTime = dts[tidyData$steps==maxNumStepsValue]
```

```{r echo=FALSE}
maxNumStepsValue
intervalOfMax
print(format(maxNumStepsDateTime, "%m/%d/%y %H:%M"))
```


##Inputing missing values

>>Note that there are a number of days/intervals where there are missing values.
>>The presence of missing days may introduce bias into some calculations or summaries of the data.

> calculate and report the total number of missing values in the dataset

rmarkdown::render(input="PA1_template.Rmd",output_format="md_document",output_file = "README.md")

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Loading and preprocessing the data

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r eval=FALSE}
library(ProjectTemplate)
load.project()
tidyData <- activity[complete.cases(activity),]
# convert date to a time series by adding the intervals in minutes
dts <- as.POSIXct(tidyData$date) + minutes(as.numeric(tidyData$interval ))
# reshape data into a 1 feature time series
tidyData <- select(tidyData ,-date,-interval)%>%
xts(order.by = dts,unique = TRUE)
```

You can also embed plots, for example:

```{r, echo=FALSE}
plot(cars)
```


## What is mean total number of steps taken per day?



## What is the average daily activity pattern?



## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
